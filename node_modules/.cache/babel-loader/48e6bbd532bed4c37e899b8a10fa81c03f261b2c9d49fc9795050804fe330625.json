{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useEditor,EditorContent}from\"@tiptap/react\";import StarterKit from\"@tiptap/starter-kit\";import Highlight from\"@tiptap/extension-highlight\";import{analyzeSentence,countWords,countSentences,calculateFleschKincaidGrade,calculateFleschReadingEase}from\"./readabilityUtils\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TiptapEditor(_ref){let{targetGrade}=_ref;const[stats,setStats]=useState({wordCount:0,sentenceCount:0,grade:0,ease:0});const editor=useEditor({extensions:[StarterKit,Highlight],content:\"<p>Start typing here…</p>\",editorProps:{attributes:{class:\"prose prose-sm sm:prose lg:prose-lg xl:prose-xl max-w-none p-4 border rounded bg-white\"}}});// update stats + highlights on every content change\nuseEffect(()=>{if(!editor)return;const onUpdate=()=>{const text=editor.getText();// 1) update stats\nsetStats({wordCount:countWords(text),sentenceCount:countSentences(text),grade:calculateFleschKincaidGrade(text),ease:calculateFleschReadingEase(text)});// 2) clear existing highlights\neditor.chain().focus().unsetHighlight().run();// 3) highlight each sentence\nlet offset=0;const sentences=text.match(/[^.!?]+[.!?]*/g)||[];for(let s of sentences){const trimmed=s.trim();const start=offset+s.indexOf(trimmed)+1;const end=start+trimmed.length;const{grade,wordCount}=analyzeSentence(trimmed);// pick color\nlet color=null;if(wordCount>=25)color=\"blue\";else if(grade>targetGrade+2)color=\"red\";else if(grade>targetGrade)color=\"yellow\";if(color){editor.chain().focus().setTextSelection({from:start,to:end}).toggleHighlight({color}).run();// add tooltip\neditor.commands.setNodeMarkup(end,undefined,{...editor.state.doc.nodeAt(end).attrs,title:`Grade ${grade} / ${wordCount} words — try splitting it`});}offset+=s.length;}// return cursor to start\neditor.chain().focus().setTextSelection(0).run();};editor.on(\"update\",onUpdate);return()=>{editor.off(\"update\",onUpdate);};},[editor,targetGrade]);if(!editor)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>editor.chain().focus().toggleBold().run(),className:\"px-2 py-1 border rounded\",children:\"Bold\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editor.chain().focus().toggleItalic().run(),className:\"px-2 py-1 border rounded\",children:\"Italic\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editor.chain().focus().toggleHeading({level:1}).run(),className:\"px-2 py-1 border rounded\",children:\"H1\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editor.chain().focus().toggleBulletList().run(),className:\"px-2 py-1 border rounded\",children:\"\\u2022 List\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editor.chain().focus().toggleOrderedList().run(),className:\"px-2 py-1 border rounded\",children:\"1. List\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"bg-gray-100 px-2 py-1 rounded\",children:[\"Words: \",stats.wordCount]}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-gray-100 px-2 py-1 rounded\",children:[\"Sentences: \",stats.sentenceCount]}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-green-100 px-2 py-1 rounded\",children:[\"Grade Level: \",stats.grade]}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-blue-100 px-2 py-1 rounded\",children:[\"Reading Ease: \",stats.ease]})]}),/*#__PURE__*/_jsx(EditorContent,{editor:editor})]});}","map":{"version":3,"names":["React","useEffect","useState","useEditor","EditorContent","StarterKit","Highlight","analyzeSentence","countWords","countSentences","calculateFleschKincaidGrade","calculateFleschReadingEase","jsx","_jsx","jsxs","_jsxs","TiptapEditor","_ref","targetGrade","stats","setStats","wordCount","sentenceCount","grade","ease","editor","extensions","content","editorProps","attributes","class","onUpdate","text","getText","chain","focus","unsetHighlight","run","offset","sentences","match","s","trimmed","trim","start","indexOf","end","length","color","setTextSelection","from","to","toggleHighlight","commands","setNodeMarkup","undefined","state","doc","nodeAt","attrs","title","on","off","className","children","onClick","toggleBold","toggleItalic","toggleHeading","level","toggleBulletList","toggleOrderedList"],"sources":["C:/Users/Mitchell/Downloads/Hemming Way App Clone/Hemming Way App Clone/src/TiptapEditor.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useEditor, EditorContent } from \"@tiptap/react\";\r\nimport StarterKit from \"@tiptap/starter-kit\";\r\nimport Highlight from \"@tiptap/extension-highlight\";\r\nimport {\r\n  analyzeSentence,\r\n  countWords,\r\n  countSentences,\r\n  calculateFleschKincaidGrade,\r\n  calculateFleschReadingEase,\r\n} from \"./readabilityUtils\";\r\n\r\nexport default function TiptapEditor({ targetGrade }) {\r\n  const [stats, setStats] = useState({\r\n    wordCount: 0,\r\n    sentenceCount: 0,\r\n    grade: 0,\r\n    ease: 0,\r\n  });\r\n\r\n  const editor = useEditor({\r\n    extensions: [StarterKit, Highlight],\r\n    content: \"<p>Start typing here…</p>\",\r\n    editorProps: {\r\n      attributes: {\r\n        class:\r\n          \"prose prose-sm sm:prose lg:prose-lg xl:prose-xl max-w-none p-4 border rounded bg-white\",\r\n      },\r\n    },\r\n  });\r\n\r\n  // update stats + highlights on every content change\r\n  useEffect(() => {\r\n    if (!editor) return;\r\n    const onUpdate = () => {\r\n      const text = editor.getText();\r\n      // 1) update stats\r\n      setStats({\r\n        wordCount: countWords(text),\r\n        sentenceCount: countSentences(text),\r\n        grade: calculateFleschKincaidGrade(text),\r\n        ease: calculateFleschReadingEase(text),\r\n      });\r\n\r\n      // 2) clear existing highlights\r\n      editor.chain().focus().unsetHighlight().run();\r\n\r\n      // 3) highlight each sentence\r\n      let offset = 0;\r\n      const sentences = text.match(/[^.!?]+[.!?]*/g) || [];\r\n      for (let s of sentences) {\r\n        const trimmed = s.trim();\r\n        const start = offset + s.indexOf(trimmed) + 1;\r\n        const end = start + trimmed.length;\r\n        const { grade, wordCount } = analyzeSentence(trimmed);\r\n\r\n        // pick color\r\n        let color = null;\r\n        if (wordCount >= 25) color = \"blue\";\r\n        else if (grade > targetGrade + 2) color = \"red\";\r\n        else if (grade > targetGrade) color = \"yellow\";\r\n\r\n        if (color) {\r\n          editor\r\n            .chain()\r\n            .focus()\r\n            .setTextSelection({ from: start, to: end })\r\n            .toggleHighlight({ color })\r\n            .run();\r\n          // add tooltip\r\n          editor.commands.setNodeMarkup(end, undefined, {\r\n            ...editor.state.doc.nodeAt(end).attrs,\r\n            title: `Grade ${grade} / ${wordCount} words — try splitting it`,\r\n          });\r\n        }\r\n\r\n        offset += s.length;\r\n      }\r\n\r\n      // return cursor to start\r\n      editor.chain().focus().setTextSelection(0).run();\r\n    };\r\n\r\n    editor.on(\"update\", onUpdate);\r\n    return () => {\r\n      editor.off(\"update\", onUpdate);\r\n    };\r\n  }, [editor, targetGrade]);\r\n\r\n  if (!editor) return null;\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* toolbar */}\r\n      <div className=\"flex flex-wrap gap-2 mb-2\">\r\n        <button\r\n          onClick={() => editor.chain().focus().toggleBold().run()}\r\n          className=\"px-2 py-1 border rounded\"\r\n        >\r\n          Bold\r\n        </button>\r\n        <button\r\n          onClick={() => editor.chain().focus().toggleItalic().run()}\r\n          className=\"px-2 py-1 border rounded\"\r\n        >\r\n          Italic\r\n        </button>\r\n        <button\r\n          onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}\r\n          className=\"px-2 py-1 border rounded\"\r\n        >\r\n          H1\r\n        </button>\r\n        <button\r\n          onClick={() => editor.chain().focus().toggleBulletList().run()}\r\n          className=\"px-2 py-1 border rounded\"\r\n        >\r\n          • List\r\n        </button>\r\n        <button\r\n          onClick={() => editor.chain().focus().toggleOrderedList().run()}\r\n          className=\"px-2 py-1 border rounded\"\r\n        >\r\n          1. List\r\n        </button>\r\n      </div>\r\n\r\n      {/* stats */}\r\n      <div className=\"flex flex-wrap gap-4 text-sm\">\r\n        <span className=\"bg-gray-100 px-2 py-1 rounded\">\r\n          Words: {stats.wordCount}\r\n        </span>\r\n        <span className=\"bg-gray-100 px-2 py-1 rounded\">\r\n          Sentences: {stats.sentenceCount}\r\n        </span>\r\n        <span className=\"bg-green-100 px-2 py-1 rounded\">\r\n          Grade Level: {stats.grade}\r\n        </span>\r\n        <span className=\"bg-blue-100 px-2 py-1 rounded\">\r\n          Reading Ease: {stats.ease}\r\n        </span>\r\n      </div>\r\n\r\n      {/* editor */}\r\n      <EditorContent editor={editor} />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}